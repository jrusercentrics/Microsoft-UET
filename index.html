<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Teste Cookiebot + Microsoft UET</title>

  <!-- Cookiebot CMP -->
  <script id="Cookiebot"
          src="https://consent.cookiebot.com/uc.js"
          data-cbid="e2769309-3672-42d4-bc3f-d56333e6a880"
          data-blockingmode="auto"
          type="text/javascript"></script>

  <!-- Consent Mode for Microsoft UET -->
  <script>
    window.uetq = window.uetq || [];

    // Definir default sempre como denied (antes de consentimento)
    window.uetq.push('consent', 'default', {
      'ad_storage': 'denied'
    });

    // Cookiebot envia updates automaticamente, mas refor√ßamos
    window.addEventListener('CookiebotOnConsentReady', function() {
      window.uetq.push('consent', 'update', {
        'ad_storage': Cookiebot.consent.marketing ? 'granted' : 'denied'
      });
      console.log("Consent updated:", Cookiebot.consent.marketing);
    });
  </script>

  <!-- Microsoft UET Tag -->
  <script>
    (function(w,d,t,r,u){
      var f,n,i;
      w[u]=w[u]||[];
      f=function(){
        var o={ti:"97203970", enableAutoSpaTracking: true};
        o.q=w[u];
        w[u]=new UET(o);
        w[u].push("pageLoad");
      };
      n=d.createElement(t);
      n.src=r;
      n.async=1;
      n.onload=n.onreadystatechange=function(){
        var s=this.readyState;
        if(!s||s==="loaded"||s==="complete"){
          f();
          n.onload=n.onreadystatechange=null;
        }
      };
      i=d.getElementsByTagName(t)[0];
      i.parentNode.insertBefore(n,i);
    })(window,document,"script","//bat.bing.com/bat.js","uetq");
  </script>
</head>
<body>
  <h1>Teste Microsoft UET + Cookiebot</h1>
  <p>Abre a consola do browser (<kbd>F12</kbd>) e verifica o <code>window.uetq</code> antes e depois de aceitar/rejeitar marketing cookies no banner do Cookiebot.</p>
</body>
</html>
